<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Comparing Ensambles &mdash; Disordered Protein Ensemble Tools 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=af2ce170"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ensemble_analysis" href="ensemble_analysis.html" />
    <link rel="prev" title="Dimensional reduction on carbon alpha distances" href="dr_cadist.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Disordered Protein Ensemble Tools
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="demo.html">Demo</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Global_analysis.html">Global analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="local_analysis.html">Local analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="dimensional_reduction.html">Dimensional Reduction Analysis</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Comparing Ensambles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#high-level-moderate-control">High level (moderate control)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#intermediate-level-slightly-more-control">Intermediate level (slightly more control)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#low-level-full-control">Low level (full control)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ensemble_analysis.html">ensemble_analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="ensemble.html">ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">visualization</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Disordered Protein Ensemble Tools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="demo.html">Demo</a></li>
      <li class="breadcrumb-item active">Comparing Ensambles</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/comparing_ensambles.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="comparing-ensambles">
<h1>Comparing Ensambles<a class="headerlink" href="#comparing-ensambles" title="Permalink to this heading"></a></h1>
<p>We have explored techniques for comparing and analyzing datasets, focusing on the calculation of various metrics such as Jensen-Shannon Divergence (JSD) and Earth Mover’s Distance (EMD).</p>
<p>Comparing datasets is crucial for understanding the similarities and differences between different datasets or models, and quantifying them can provide insights into the underlying patterns and distributions present in the data.</p>
<p>Practical examples are provided, demonstrating how to manually calculate these metrics, referring to 3 ensembles downloaded directly from the Protein Ensemble Database (PED): PED00156, PED00157, and PED00158. These ensembles represent structural states of the N-terminal SH3 domain of the Drk protein (residues 1-59) in its unfolded form, generated with different approaches to initialize pools of random conformations.</p>
<section id="high-level-moderate-control">
<h2>High level (moderate control)<a class="headerlink" href="#high-level-moderate-control" title="Permalink to this heading"></a></h2>
<p>The code performs two comparative visualizations using the Jensen-Shannon Divergence (JSD) score:</p>
<ol class="arabic simple">
<li><p><strong>ca_dist</strong>: Comparison of the distributions of the feature ca_dist, visualized with the “Oranges” color map.</p></li>
<li><p><strong>alpha_angle</strong>: Comparison of the distributions of the feature alpha_angle, visualized with the “Purples” color map.</p></li>
</ol>
<p><strong>JSD (Jensen-Shannon Divergence)</strong> is a measure of similarity between two probability distributions. It is based on the Kullback-Leibler (KL) divergence but is symmetric and bounded between 0 and 1, where 0 indicates that the distributions are identical and 1 indicates maximum difference.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bootstrap_iters</span><span class="o">=</span><span class="mi">5</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">comparison_matrix</span><span class="p">(</span>
   <span class="n">score</span><span class="o">=</span><span class="s2">&quot;jsd&quot;</span><span class="p">,</span><span class="n">feature</span><span class="o">=</span><span class="s2">&quot;ca_dist&quot;</span><span class="p">,</span>
   <span class="n">bootstrap_iters</span><span class="o">=</span><span class="n">bootstrap_iters</span><span class="p">,</span>
   <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
   <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
   <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Oranges&quot;</span><span class="p">,</span>
   <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">comparison_matrix</span><span class="p">(</span>
   <span class="n">score</span><span class="o">=</span><span class="s2">&quot;jsd&quot;</span><span class="p">,</span>
   <span class="n">feature</span><span class="o">=</span><span class="s2">&quot;alpha_angle&quot;</span><span class="p">,</span>
   <span class="n">bootstrap_iters</span><span class="o">=</span><span class="n">bootstrap_iters</span><span class="p">,</span>
   <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
   <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
   <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Purples&quot;</span><span class="p">,</span>
   <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="images/sh3/comparing_ensambles/comp_hl_JSD.png" class="align-center" src="images/sh3/comparing_ensambles/comp_hl_JSD.png" />
<p>We note that each feature is compared across 6 pairs of ensembles, with 5 bootstrap iterations for each pair, for a total of 30 comparisons.</p>
<img alt="images/sh3/comparing_ensambles/comparing_hl_JSD.png" class="align-center" src="images/sh3/comparing_ensambles/comparing_hl_JSD.png" />
<p>The Jensen-Shannon divergence between the distributions of <em>ca_dist</em> provides an indication of how different the calcium distributions are across the different pairs of ensembles. A low JSD value would indicate that the distributions are very similar, while a high value would indicate very different distributions.</p>
<p>Similarly, the JSD calculated for <em>alpha_angle</em> measures the difference between the distributions of alpha angles among the pairs of ensembles. This can help understand how the alpha angles vary between different conditions or configurations.</p>
<p>Similarly, now the code performs the same two comparative visualizations using the EMD metric.</p>
<p><strong>The Earth Mover’s Distance (EMD)</strong> is a measure of the distance between two probability distributions and is calculated as the minimum cost of transforming one distribution into the other, where the cost is defined in terms of the “work” needed to move the probability mass.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">comparison_matrix</span><span class="p">(</span>
 <span class="n">score</span><span class="o">=</span><span class="s2">&quot;emd&quot;</span><span class="p">,</span>
 <span class="n">feature</span><span class="o">=</span><span class="s2">&quot;ca_dist&quot;</span><span class="p">,</span>
 <span class="n">bootstrap_iters</span><span class="o">=</span><span class="n">bootstrap_iters</span><span class="p">,</span>
 <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
 <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
 <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Reds&quot;</span><span class="p">,</span>
 <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">visualization</span><span class="o">.</span><span class="n">comparison_matrix</span><span class="p">(</span>
 <span class="n">score</span><span class="o">=</span><span class="s2">&quot;emd&quot;</span><span class="p">,</span>
 <span class="n">feature</span><span class="o">=</span><span class="s2">&quot;alpha_angle&quot;</span><span class="p">,</span>
 <span class="n">bootstrap_iters</span><span class="o">=</span><span class="n">bootstrap_iters</span><span class="p">,</span>
 <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
 <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
 <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greens&quot;</span><span class="p">,</span>
 <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="images/sh3/comparing_ensambles/comp_hl_EMD.png" class="align-center" src="images/sh3/comparing_ensambles/comp_hl_EMD.png" />
<ul class="simple">
<li><p>each feature is compared across 6 pairs of ensembles, with 5 bootstrap iterations for each pair, for a total of 30 comparisons.</p></li>
<li><p>Distance Function (RMSD): The Root Mean Square Deviation (RMSD) is used to compare the distributions of ca_dist. This function measures the mean quadratic difference between two distributions, providing a clear and intuitive indication of the differences between them.</p></li>
<li><p>Distance Function (Angular L2): The L2 norm for angles is used to compare the distributions of alpha_angle. This metric is appropriate for measuring differences between angles, as it takes into account the cyclic nature of angles and possible discontinuities.</p></li>
</ul>
<img alt="images/sh3/comparing_ensambles/comparing_hl_EMD.png" src="images/sh3/comparing_ensambles/comparing_hl_EMD.png" />
<p>The <strong>EMD</strong> can range from 0 to ∞ (infinity).</p>
<ul class="simple">
<li><p>A low value of EMD indicates that the two distributions are very similar, requiring little “work” to transform one distribution into the other.</p></li>
<li><p>A high value of EMD indicates that the two distributions are very different.</p></li>
</ul>
</section>
<section id="intermediate-level-slightly-more-control">
<h2>Intermediate level (slightly more control)<a class="headerlink" href="#intermediate-level-slightly-more-control" title="Permalink to this heading"></a></h2>
<p>The provided code manually calculates the JSD divergence scores between all ensemble pairs using the Ensemble class.</p>
<p>Using EnsembleAnalysis to manually calculate divergence scores allows for detailed customization of the analysis process. You can choose the type of score, the number of bootstrap iterations, the method for bins, and more.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">boostrap_iters</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">bins</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span>
<span class="n">score</span> <span class="o">=</span> <span class="s2">&quot;jsd&quot;</span>

<span class="c1"># Score divergences in Ca-Ca distances.</span>
<span class="n">ca_dist_scores</span><span class="p">,</span> <span class="n">codes</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">comparison_scores</span><span class="p">(</span>
 <span class="n">score</span><span class="o">=</span><span class="n">score</span><span class="p">,</span>
 <span class="n">feature</span><span class="o">=</span><span class="s2">&quot;ca_dist&quot;</span><span class="p">,</span>
 <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
 <span class="n">bootstrap_iters</span><span class="o">=</span><span class="n">boostrap_iters</span><span class="p">,</span>
 <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Score divergences in alpha torsions.</span>
<span class="n">alpha_angles_scores</span><span class="p">,</span> <span class="n">codes</span> <span class="o">=</span> <span class="n">analysis</span><span class="o">.</span><span class="n">comparison_scores</span><span class="p">(</span>
 <span class="n">score</span><span class="o">=</span><span class="n">score</span><span class="p">,</span>
 <span class="n">feature</span><span class="o">=</span><span class="s2">&quot;alpha_angle&quot;</span><span class="p">,</span>
 <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
 <span class="n">bootstrap_iters</span><span class="o">=</span><span class="n">boostrap_iters</span><span class="p">,</span>
 <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<p>After using the comparison_scores function of the analysis class to manually calculate the JSD scores for each feature (ca_dist and alpha_angle), the plot_comparison_matrix function is used to visualize the results.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">14.0</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>

<span class="n">show_std</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">plot_comparison_matrix</span><span class="p">(</span>
 <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
 <span class="n">scores</span><span class="o">=</span><span class="n">ca_dist_scores</span><span class="p">,</span>
 <span class="n">codes</span><span class="o">=</span><span class="n">codes</span><span class="p">,</span>
 <span class="n">std</span><span class="o">=</span><span class="n">show_std</span><span class="p">,</span>
 <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Oranges&quot;</span><span class="p">,</span>
 <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Distance distributions (aJSD_d)&quot;</span><span class="p">,</span>
 <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;aJSD_d score&quot;</span><span class="p">,</span>
 <span class="n">textcolors</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="s2">&quot;white&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">plot_comparison_matrix</span><span class="p">(</span>
 <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
 <span class="n">scores</span><span class="o">=</span><span class="n">alpha_angles_scores</span><span class="p">,</span>
 <span class="n">codes</span><span class="o">=</span><span class="n">codes</span><span class="p">,</span>
 <span class="n">std</span><span class="o">=</span><span class="n">show_std</span><span class="p">,</span>
 <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Purples&quot;</span><span class="p">,</span>
 <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Alpha angles distributions (aJSD_t)&quot;</span><span class="p">,</span>
 <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;aJSD_t score&quot;</span><span class="p">,</span>
 <span class="n">textcolors</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span>  <span class="c1"># Changes text color.</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="images/sh3/comparing_ensambles/comparing_il.png" class="align-center" src="images/sh3/comparing_ensambles/comparing_il.png" />
<p>This function accepts manually calculated scores and displays them, allowing for greater customization of the graphs.</p>
<p>On the other hand, the previous code (high level-moderate control) directly uses the comparison_matrix function to calculate and display the results in a single step, without the possibility of further customizing the graphs. Therefore, it is simpler and more automated but with fewer customization options.</p>
</section>
<section id="low-level-full-control">
<h2>Low level (full control)<a class="headerlink" href="#low-level-full-control" title="Permalink to this heading"></a></h2>
<p>The following code is an example of how to manually calculate JSD (Jensen-Shannon Divergence) and EMD (Earth Mover’s Distance) scores between two sets of data. This approach is more manual and provides the highest level of control, as features are extracted manually and scores are calculated without using automated library functions for visualization.
It allows for customization at every step, from feature calculation to implementing one’s own bootstrap strategy.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ens_1</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s2">&quot;PED00156e001&quot;</span><span class="p">]</span>
<span class="n">ens_2</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s2">&quot;PED00157e001&quot;</span><span class="p">]</span>
<span class="n">ens_3</span> <span class="o">=</span> <span class="n">analysis</span><span class="p">[</span><span class="s2">&quot;PED00158e001&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Here, the aJSD score is calculated for calcium distances (aJSD_d) and for alpha angles (aJSD_t) between two sets of data.
The variables score_ajsd_d and score_ajsd_t are functions that perform these calculations, also returning the number of bins used.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">score</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">score_ajsd_d</span><span class="p">(</span><span class="n">ens_1</span><span class="p">,</span> <span class="n">ens_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">return_bins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- aJSD_d score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, bins used: </span><span class="si">{</span><span class="n">bins</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">score</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">score_ajsd_t</span><span class="p">(</span><span class="n">ens_1</span><span class="p">,</span> <span class="n">ens_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">return_bins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- aJSD_t score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, bins used: </span><span class="si">{</span><span class="n">bins</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="images/sh3/comparing_ensambles/comp_ll_12.png" src="images/sh3/comparing_ensambles/comp_ll_12.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">score</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">score_ajsd_d</span><span class="p">(</span><span class="n">ens_1</span><span class="p">,</span> <span class="n">ens_3</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">return_bins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- aJSD_d score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, bins used: </span><span class="si">{</span><span class="n">bins</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">score</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">score_ajsd_t</span><span class="p">(</span><span class="n">ens_1</span><span class="p">,</span> <span class="n">ens_3</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">return_bins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- aJSD_t score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, bins used: </span><span class="si">{</span><span class="n">bins</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="images/sh3/comparing_ensambles/comp_ll_13.png" src="images/sh3/comparing_ensambles/comp_ll_13.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">score</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">score_ajsd_d</span><span class="p">(</span><span class="n">ens_2</span><span class="p">,</span> <span class="n">ens_3</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">return_bins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- aJSD_d score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, bins used: </span><span class="si">{</span><span class="n">bins</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">score</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">score_ajsd_t</span><span class="p">(</span><span class="n">ens_2</span><span class="p">,</span> <span class="n">ens_3</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">return_bins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- aJSD_t score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, bins used: </span><span class="si">{</span><span class="n">bins</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="images/sh3/comparing_ensambles/comp_ll_23.png" src="images/sh3/comparing_ensambles/comp_ll_23.png" />
<p>This code demonstrates how to manually extract alpha angles from each dataset and calculate the average JSD score using these features.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Manually compute features (alpha_angles).</span>
<span class="n">alpha_1</span> <span class="o">=</span> <span class="n">ens_1</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">featurization</span><span class="o">=</span><span class="s2">&quot;a_angle&quot;</span><span class="p">)</span>
<span class="n">alpha_2</span> <span class="o">=</span> <span class="n">ens_2</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">featurization</span><span class="o">=</span><span class="s2">&quot;a_angle&quot;</span><span class="p">)</span>
<span class="n">alpha_3</span> <span class="o">=</span> <span class="n">ens_3</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">featurization</span><span class="o">=</span><span class="s2">&quot;a_angle&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- features 1 shape:&quot;</span><span class="p">,</span> <span class="n">alpha_1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- features 2 shape:&quot;</span><span class="p">,</span> <span class="n">alpha_2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1"># Manually compute average JSD approximation. You can also provide any other</span>
<span class="c1"># 2d feature matrix as input to the `score_avg_jsd` function.</span>
<span class="n">score</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">score_avg_jsd</span><span class="p">(</span><span class="n">alpha_1</span><span class="p">,</span> <span class="n">alpha_2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">return_bins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- aJSD_t score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, bins used: </span><span class="si">{</span><span class="n">bins</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- features 1 shape:&quot;</span><span class="p">,</span> <span class="n">alpha_1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- features 3 shape:&quot;</span><span class="p">,</span> <span class="n">alpha_3</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">score</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">score_avg_jsd</span><span class="p">(</span><span class="n">alpha_1</span><span class="p">,</span> <span class="n">alpha_3</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">return_bins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- aJSD_t score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, bins used: </span><span class="si">{</span><span class="n">bins</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- features 2 shape:&quot;</span><span class="p">,</span> <span class="n">alpha_2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- features 3 shape:&quot;</span><span class="p">,</span> <span class="n">alpha_3</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">score</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">score_avg_jsd</span><span class="p">(</span><span class="n">alpha_2</span><span class="p">,</span> <span class="n">alpha_3</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">return_bins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- aJSD_t score: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, bins used: </span><span class="si">{</span><span class="n">bins</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="images/sh3/comparing_ensambles/comp_ll_1.png" src="images/sh3/comparing_ensambles/comp_ll_1.png" />
<p>Finally, the EMD score between the extracted features is manually computed. For angular features, angular_l2 is used as the comparison metric.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s compute features (alpha_angles).</span>
<span class="n">alpha_1</span> <span class="o">=</span> <span class="n">ens_1</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">featurization</span><span class="o">=</span><span class="s2">&quot;a_angle&quot;</span><span class="p">)</span>
<span class="n">alpha_2</span> <span class="o">=</span> <span class="n">ens_2</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">featurization</span><span class="o">=</span><span class="s2">&quot;a_angle&quot;</span><span class="p">)</span>
<span class="n">alpha_3</span> <span class="o">=</span> <span class="n">ens_3</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">featurization</span><span class="o">=</span><span class="s2">&quot;a_angle&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- features 1 shape:&quot;</span><span class="p">,</span> <span class="n">alpha_1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- features 2 shape:&quot;</span><span class="p">,</span> <span class="n">alpha_2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="c1"># Manually score EMD approximation. NOTE: since we are comparing angular features,</span>
<span class="c1"># make sure to use `angular_l2` as the `metric` argument. For all other features</span>
<span class="c1"># (e.g.: interatomic distances) you should use `rmsd` or `l2` instead.</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">score_emd_approximation</span><span class="p">(</span><span class="n">alpha_1</span><span class="p">,</span> <span class="n">alpha_2</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;angular_l2&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- EMD on alpha angles: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- features 1 shape:&quot;</span><span class="p">,</span> <span class="n">alpha_1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- features 3 shape:&quot;</span><span class="p">,</span> <span class="n">alpha_3</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">score_emd_approximation</span><span class="p">(</span><span class="n">alpha_1</span><span class="p">,</span> <span class="n">alpha_3</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;angular_l2&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- EMD on alpha angles: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- features 2 shape:&quot;</span><span class="p">,</span> <span class="n">alpha_2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- features 3 shape:&quot;</span><span class="p">,</span> <span class="n">alpha_3</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">score</span> <span class="o">=</span> <span class="n">score_emd_approximation</span><span class="p">(</span><span class="n">alpha_2</span><span class="p">,</span> <span class="n">alpha_3</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s2">&quot;angular_l2&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- EMD on alpha angles: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="images/sh3/comparing_ensambles/comp_ll_2.png" src="images/sh3/comparing_ensambles/comp_ll_2.png" />
<p>Note that visualization is not directly included in the code, unlike previous examples where comparison matrices were created and displayed automatically.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dr_cadist.html" class="btn btn-neutral float-left" title="Dimensional reduction on carbon alpha distances" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ensemble_analysis.html" class="btn btn-neutral float-right" title="ensemble_analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Hamidreza Ghafouri, Giacomo Janson, Nikola Ivanović.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>